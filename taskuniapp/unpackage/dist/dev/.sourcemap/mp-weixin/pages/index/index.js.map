{"version":3,"file":"index.js","sources":["pages/index/index.vue","pages/index/index.vue?type=page"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<!-- È°∂ÈÉ®ÁªüËÆ° - Âõ∫ÂÆö -->\r\n\t\t<view class=\"stats-card\">\r\n\t\t\t<view class=\"stat-item\">\r\n\t\t\t\t<text class=\"stat-num\">{{ taskStats.total }}</text>\r\n\t\t\t\t<text class=\"stat-label\">ÊÄª‰ªªÂä°</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"stat-item\">\r\n\t\t\t\t<text class=\"stat-num\">{{ taskStats.active }}</text>\r\n\t\t\t\t<text class=\"stat-label\">ËøõË°å‰∏≠</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"stat-item\">\r\n\t\t\t\t<text class=\"stat-num\">{{ taskStats.totalCheckins }}</text>\r\n\t\t\t\t<text class=\"stat-label\">Á¥ØËÆ°ÊâìÂç°</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- ‰ªªÂä°ÂàóË°® - ÂèØÊªöÂä® -->\r\n\t\t<scroll-view class=\"task-scroll\" scroll-y>\r\n\t\t\t<view class=\"task-list\">\r\n\t\t\t\t<view v-if=\"taskList.length === 0\" class=\"empty\">\r\n\t\t\t\t\t<text class=\"empty-text\" v-if=\"!isGuestMode\">ÊöÇÊó†‰ªªÂä°ÔºåÁÇπÂáª‰∏ãÊñπÊåâÈíÆÂàõÂª∫</text>\r\n\t\t\t\t\t<view v-else class=\"guest-tip\">\r\n\t\t\t\t\t\t<text class=\"guest-text\">üëã Ê¨¢Ëøé‰ΩìÈ™å‰ªªÂä°ÊâìÂç°</text>\r\n\t\t\t\t\t\t<text class=\"guest-desc\">ÁôªÂΩïÂêéÂç≥ÂèØÂàõÂª∫‰ªªÂä°Âπ∂ÂºÄÂßãÊâìÂç°</text>\r\n\t\t\t\t\t\t<button class=\"guest-login-btn\" @click=\"goToLogin\">Á´ãÂç≥ÁôªÂΩï</button>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<view v-for=\"task in taskList\" :key=\"task.id\" class=\"task-item\" @click=\"goToDetail(task.id)\">\r\n\t\t\t\t\t<view class=\"task-header\">\r\n\t\t\t\t\t\t<view class=\"title-row\">\r\n\t\t\t\t\t\t\t<view class=\"category-tag\" :class=\"'category-' + task.category\">\r\n\t\t\t\t\t\t\t\t<text>{{ getCategoryName(task.category) }}</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<text class=\"task-title\">{{ task.title }}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<text class=\"task-status\" :class=\"task.status === 1 ? 'active' : 'completed'\">\r\n\t\t\t\t\t\t\t{{ task.status === 1 ? 'ËøõË°å‰∏≠' : 'Â∑≤ÂÆåÊàê' }}\r\n\t\t\t\t\t\t</text>\r\n\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t<view class=\"task-progress\">\r\n\t\t\t\t\t\t<text class=\"progress-text\">ËøûÁª≠ {{ task.current_days }} Â§©</text>\r\n\t\t\t\t\t\t<text class=\"progress-text\">Á¥ØËÆ° {{ task.total_days }} Â§©</text>\r\n\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t<view v-if=\"task.target_days > 0\" class=\"task-target\">\r\n\t\t\t\t\t\t<text class=\"target-text\">ÁõÆÊ†á: {{ task.target_days }} Â§©</text>\r\n\t\t\t\t\t\t<view class=\"progress-bar\">\r\n\t\t\t\t\t\t\t<view class=\"progress-fill\" :style=\"{ width: getProgress(task) + '%' }\"></view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</scroll-view>\r\n\r\n\t\t<!-- ÂàõÂª∫ÊåâÈíÆ -->\r\n\t\t<view class=\"create-btn\" @click=\"goToCreate\">\r\n\t\t\t<text class=\"iconfont icon-jia\"></text>\r\n\t\t</view>\r\n\r\n\t\t<!-- Ëá™ÂÆö‰πâ TabBar -->\r\n\t\t<custom-tabbar />\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport customTabbar from '@/components/custom-tabbar/custom-tabbar.vue';\r\nimport { getTaskList } from '@/api/task';\r\n\r\nexport default {\r\n\tcomponents: {\r\n\t\tcustomTabbar\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\ttaskList: [],\r\n\t\t\ttaskStats: {\r\n\t\t\t\ttotal: 0,\r\n\t\t\t\tactive: 0,\r\n\t\t\t\ttotalCheckins: 0\r\n\t\t\t},\r\n\t\t\tisGuestMode: false\r\n\t\t};\r\n\t},\r\n\tonLoad() {\r\n\t\t// Ê£ÄÊü•ÊòØÂê¶‰∏∫Ê∏∏ÂÆ¢Ê®°Âºè\r\n\t\tconst token = uni.getStorageSync('token');\r\n\t\tthis.isGuestMode = !token;\r\n\t},\r\n\tonShow() {\r\n\t\tconst token = uni.getStorageSync('token');\r\n\t\tconst isGuestMode = uni.getStorageSync('isGuestMode');\r\n\r\n\t\tconsole.log('=== È¶ñÈ°µÂä†ËΩΩ ===');\r\n\t\tconsole.log('Token:', token ? token.substring(0, 20) + '...' : 'Êó†');\r\n\t\tconsole.log('Ê∏∏ÂÆ¢Ê®°Âºè:', isGuestMode);\r\n\r\n\t\tif (token) {\r\n\t\t\t// Â∑≤ÁôªÂΩïÔºåÂä†ËΩΩ‰ªªÂä°ÂàóË°®\r\n\t\t\tthis.loadTaskList();\r\n\t\t} else {\r\n\t\t\t// Ê∏∏ÂÆ¢Ê®°ÂºèÔºåÊòæÁ§∫Á©∫Áä∂ÊÄÅ\r\n\t\t\tthis.taskList = [];\r\n\t\t\tthis.calculateStats();\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tasync loadTaskList() {\r\n\t\t\ttry {\r\n\t\t\t\tconsole.log('ÂºÄÂßãÂä†ËΩΩ‰ªªÂä°ÂàóË°®...');\r\n\t\t\t\tconst res = await getTaskList();\r\n\t\t\t\tconsole.log('‰ªªÂä°ÂàóË°®ÂìçÂ∫î:', res);\r\n\r\n\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\tthis.taskList = res.data;\r\n\t\t\t\t\tconsole.log('‰ªªÂä°ÂàóË°®Êï∞ÊçÆ:', this.taskList);\r\n\t\t\t\t\tthis.calculateStats();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.error('Ëé∑Âèñ‰ªªÂä°ÂàóË°®Â§±Ë¥•:', res);\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: res.message || 'Ëé∑Âèñ‰ªªÂä°Â§±Ë¥•',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error('Âä†ËΩΩ‰ªªÂä°ÂàóË°®ÈîôËØØ:', error);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tcalculateStats() {\r\n\t\t\tthis.taskStats.total = this.taskList.length;\r\n\t\t\tthis.taskStats.active = this.taskList.filter(t => t.status === 1).length;\r\n\t\t\tthis.taskStats.totalCheckins = this.taskList.reduce((sum, t) => sum + t.total_days, 0);\r\n\t\t},\r\n\r\n\t\tgetProgress(task) {\r\n\t\t\tif (task.target_days === 0) return 0;\r\n\t\t\treturn Math.min((task.total_days / task.target_days) * 100, 100);\r\n\t\t},\r\n\r\n\t\tgoToDetail(id) {\r\n\t\t\t// Ê£ÄÊü•ÊòØÂê¶‰∏∫Ê∏∏ÂÆ¢Ê®°Âºè\r\n\t\t\tif (this.checkGuestMode()) return;\r\n\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: `/pages/task/detail?id=${id}`\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tgoToCreate() {\r\n\t\t\t// Ê£ÄÊü•ÊòØÂê¶‰∏∫Ê∏∏ÂÆ¢Ê®°Âºè\r\n\t\t\tif (this.checkGuestMode()) return;\r\n\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: '/pages/task/create'\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t// Ê£ÄÊü•Ê∏∏ÂÆ¢Ê®°Âºè\r\n\t\tcheckGuestMode() {\r\n\t\t\tconst token = uni.getStorageSync('token');\r\n\t\t\tif (!token) {\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: 'ÊèêÁ§∫',\r\n\t\t\t\t\tcontent: 'ËØ∑ÂÖàÁôªÂΩïÂêé‰ΩøÁî®Ê≠§ÂäüËÉΩ',\r\n\t\t\t\t\tconfirmText: 'ÂéªÁôªÂΩï',\r\n\t\t\t\t\tcancelText: 'ÁªßÁª≠ÊµèËßà',\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\t\t\turl: '/pages/login/login'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\r\n\t\t// Ë∑≥ËΩ¨Âà∞ÁôªÂΩïÈ°µ\r\n\t\tgoToLogin() {\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: '/pages/login/login'\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tgetCategoryName(category) {\r\n\t\t\tconst names = {\r\n\t\t\t\tstudy: 'Â≠¶‰π†',\r\n\t\t\t\tsport: 'ËøêÂä®',\r\n\t\t\t\tread: 'ÈòÖËØª',\r\n\t\t\t\thealth: 'ÂÅ•Â∫∑',\r\n\t\t\t\twork: 'Â∑•‰Ωú',\r\n\t\t\t\tother: 'ÂÖ∂‰ªñ'\r\n\t\t\t};\r\n\t\t\treturn names[category] || 'ÂÖ∂‰ªñ';\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.container {\r\n\theight: 100vh;\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tbackground: #F5F5F5;\r\n}\r\n\r\n.stats-card {\r\n\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n\tpadding: 40rpx;\r\n\tdisplay: flex;\r\n\tjustify-content: space-around;\r\n\tflex-shrink: 0;\r\n}\r\n\r\n.stat-item {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\talign-items: center;\r\n}\r\n\r\n.stat-num {\r\n\tfont-size: 48rpx;\r\n\tfont-weight: bold;\r\n\tcolor: #FFFFFF;\r\n}\r\n\r\n.stat-label {\r\n\tfont-size: 24rpx;\r\n\tcolor: rgba(255, 255, 255, 0.8);\r\n\tmargin-top: 10rpx;\r\n}\r\n\r\n.task-scroll {\r\n\tflex: 1;\r\n\theight: 0;\r\n}\r\n\r\n.task-list {\r\n\tpadding: 20rpx;\r\n\tpadding-bottom: 180rpx;\r\n}\r\n\r\n.empty {\r\n\ttext-align: center;\r\n\tpadding: 100rpx 0;\r\n}\r\n\r\n.empty-text {\r\n\tfont-size: 28rpx;\r\n\tcolor: #999999;\r\n}\r\n\r\n.guest-tip {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\talign-items: center;\r\n\tgap: 20rpx;\r\n}\r\n\r\n.guest-text {\r\n\tfont-size: 32rpx;\r\n\tcolor: #333333;\r\n\tfont-weight: bold;\r\n}\r\n\r\n.guest-desc {\r\n\tfont-size: 26rpx;\r\n\tcolor: #666666;\r\n}\r\n\r\n.guest-login-btn {\r\n\tmargin-top: 20rpx;\r\n\twidth: 300rpx;\r\n\theight: 70rpx;\r\n\tline-height: 70rpx;\r\n\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n\tcolor: #FFFFFF;\r\n\tborder-radius: 35rpx;\r\n\tfont-size: 28rpx;\r\n\tborder: none;\r\n}\r\n\r\n.task-item {\r\n\tbackground: #FFFFFF;\r\n\tborder-radius: 16rpx;\r\n\tpadding: 30rpx;\r\n\tmargin-bottom: 20rpx;\r\n\tbox-shadow: 0 2rpx 12rpx rgba(0, 0, 0, 0.08);\r\n}\r\n\r\n.task-header {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: flex-start;\r\n\tmargin-bottom: 20rpx;\r\n}\r\n\r\n.title-row {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tflex: 1;\r\n\tflex-wrap: wrap;\r\n}\r\n\r\n.category-tag {\r\n\tpadding: 4rpx 12rpx;\r\n\tborder-radius: 8rpx;\r\n\tfont-size: 20rpx;\r\n\tmargin-right: 10rpx;\r\n\tflex-shrink: 0;\r\n}\r\n\r\n.category-study {\r\n\tbackground: #E3F2FD;\r\n\tcolor: #2196F3;\r\n}\r\n\r\n.category-sport {\r\n\tbackground: #FFF3E0;\r\n\tcolor: #FF9800;\r\n}\r\n\r\n.category-read {\r\n\tbackground: #F3E5F5;\r\n\tcolor: #9C27B0;\r\n}\r\n\r\n.category-health {\r\n\tbackground: #E8F5E9;\r\n\tcolor: #4CAF50;\r\n}\r\n\r\n.category-work {\r\n\tbackground: #FBE9E7;\r\n\tcolor: #FF5722;\r\n}\r\n\r\n.category-other {\r\n\tbackground: #F5F5F5;\r\n\tcolor: #757575;\r\n}\r\n\r\n.task-title {\r\n\tfont-size: 32rpx;\r\n\tfont-weight: bold;\r\n\tcolor: #333333;\r\n\tflex: 1;\r\n}\r\n\r\n.task-status {\r\n\tfont-size: 24rpx;\r\n\tpadding: 8rpx 16rpx;\r\n\tborder-radius: 20rpx;\r\n}\r\n\r\n.task-status.active {\r\n\tbackground: #E8F5E9;\r\n\tcolor: #4CAF50;\r\n}\r\n\r\n.task-status.completed {\r\n\tbackground: #E3F2FD;\r\n\tcolor: #2196F3;\r\n}\r\n\r\n.task-progress {\r\n\tdisplay: flex;\r\n\tgap: 30rpx;\r\n\tmargin-bottom: 20rpx;\r\n}\r\n\r\n.progress-text {\r\n\tfont-size: 28rpx;\r\n\tcolor: #666666;\r\n}\r\n\r\n.task-target {\r\n\tmargin-top: 20rpx;\r\n}\r\n\r\n.target-text {\r\n\tfont-size: 24rpx;\r\n\tcolor: #999999;\r\n}\r\n\r\n.progress-bar {\r\n\theight: 8rpx;\r\n\tbackground: #E0E0E0;\r\n\tborder-radius: 4rpx;\r\n\tmargin-top: 10rpx;\r\n\toverflow: hidden;\r\n}\r\n\r\n.progress-fill {\r\n\theight: 100%;\r\n\tbackground: linear-gradient(90deg, #667eea 0%, #764ba2 100%);\r\n\ttransition: width 0.3s;\r\n}\r\n\r\n.create-btn {\r\n\tposition: fixed;\r\n\tright: 40rpx;\r\n\tbottom: 180rpx;\r\n\twidth: 100rpx;\r\n\theight: 100rpx;\r\n\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n\tborder-radius: 50%;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tbox-shadow: 0 4rpx 20rpx rgba(102, 126, 234, 0.4);\r\n\tz-index: 100;\r\n}\r\n\r\n.create-btn .iconfont {\r\n\tfont-size: 36rpx;\r\n\tcolor: #FFFFFF;\r\n\tline-height: 1;\r\n}\r\n</style>\r\n","import MiniProgramPage from '/Users/sunyizhong/uni-app/HBuilderProjects/taskuniapp/pages/index/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","getTaskList"],"mappings":";;;AAqEA,MAAO,eAAc,MAAW;AAGhC,MAAK,YAAU;AAAA,EACd,YAAY;AAAA,IACX;AAAA,EACA;AAAA,EACD,OAAO;AACN,WAAO;AAAA,MACN,UAAU,CAAE;AAAA,MACZ,WAAW;AAAA,QACV,OAAO;AAAA,QACP,QAAQ;AAAA,QACR,eAAe;AAAA,MACf;AAAA,MACD,aAAa;AAAA;EAEd;AAAA,EACD,SAAS;AAER,UAAM,QAAQA,cAAAA,MAAI,eAAe,OAAO;AACxC,SAAK,cAAc,CAAC;AAAA,EACpB;AAAA,EACD,SAAS;AACR,UAAM,QAAQA,cAAAA,MAAI,eAAe,OAAO;AACxC,UAAM,cAAcA,cAAAA,MAAI,eAAe,aAAa;AAEpDA,kBAAAA,MAAY,MAAA,OAAA,+BAAA,cAAc;AAC1BA,kBAAAA,MAAY,MAAA,OAAA,+BAAA,UAAU,QAAQ,MAAM,UAAU,GAAG,EAAE,IAAI,QAAQ,GAAG;AAClEA,kBAAY,MAAA,MAAA,OAAA,+BAAA,SAAS,WAAW;AAEhC,QAAI,OAAO;AAEV,WAAK,aAAY;AAAA,WACX;AAEN,WAAK,WAAW;AAChB,WAAK,eAAc;AAAA,IACpB;AAAA,EACA;AAAA,EACD,SAAS;AAAA,IACR,MAAM,eAAe;AACpB,UAAI;AACHA,sBAAAA,mDAAY,aAAa;AACzB,cAAM,MAAM,MAAMC,SAAAA;AAClBD,sBAAA,MAAA,MAAA,OAAA,gCAAY,WAAW,GAAG;AAE1B,YAAI,IAAI,SAAS,KAAK;AACrB,eAAK,WAAW,IAAI;AACpBA,wBAAY,MAAA,MAAA,OAAA,gCAAA,WAAW,KAAK,QAAQ;AACpC,eAAK,eAAc;AAAA,eACb;AACNA,6EAAc,aAAa,GAAG;AAC9BA,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO,IAAI,WAAW;AAAA,YACtB,MAAM;AAAA,UACP,CAAC;AAAA,QACF;AAAA,MACC,SAAO,OAAO;AACfA,sBAAc,MAAA,MAAA,SAAA,gCAAA,aAAa,KAAK;AAAA,MACjC;AAAA,IACA;AAAA,IAED,iBAAiB;AAChB,WAAK,UAAU,QAAQ,KAAK,SAAS;AACrC,WAAK,UAAU,SAAS,KAAK,SAAS,OAAO,OAAK,EAAE,WAAW,CAAC,EAAE;AAClE,WAAK,UAAU,gBAAgB,KAAK,SAAS,OAAO,CAAC,KAAK,MAAM,MAAM,EAAE,YAAY,CAAC;AAAA,IACrF;AAAA,IAED,YAAY,MAAM;AACjB,UAAI,KAAK,gBAAgB;AAAG,eAAO;AACnC,aAAO,KAAK,IAAK,KAAK,aAAa,KAAK,cAAe,KAAK,GAAG;AAAA,IAC/D;AAAA,IAED,WAAW,IAAI;AAEd,UAAI,KAAK,eAAc;AAAI;AAE3BA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,yBAAyB,EAAE;AAAA,MACjC,CAAC;AAAA,IACD;AAAA,IAED,aAAa;AAEZ,UAAI,KAAK,eAAc;AAAI;AAE3BA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,MACN,CAAC;AAAA,IACD;AAAA;AAAA,IAGD,iBAAiB;AAChB,YAAM,QAAQA,cAAAA,MAAI,eAAe,OAAO;AACxC,UAAI,CAAC,OAAO;AACXA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,SAAS;AAAA,UACT,aAAa;AAAA,UACb,YAAY;AAAA,UACZ,SAAS,CAAC,QAAQ;AACjB,gBAAI,IAAI,SAAS;AAChBA,4BAAAA,MAAI,WAAW;AAAA,gBACd,KAAK;AAAA,cACN,CAAC;AAAA,YACF;AAAA,UACD;AAAA,QACD,CAAC;AACD,eAAO;AAAA,MACR;AACA,aAAO;AAAA,IACP;AAAA;AAAA,IAGD,YAAY;AACXA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,MACN,CAAC;AAAA,IACD;AAAA,IAED,gBAAgB,UAAU;AACzB,YAAM,QAAQ;AAAA,QACb,OAAO;AAAA,QACP,OAAO;AAAA,QACP,MAAM;AAAA,QACN,QAAQ;AAAA,QACR,MAAM;AAAA,QACN,OAAO;AAAA;AAER,aAAO,MAAM,QAAQ,KAAK;AAAA,IAC3B;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzMA,GAAG,WAAW,eAAe;"}