{"version":3,"file":"test-userinfo.js","sources":["pages/test-userinfo.vue","pages/test-userinfo.vue?type=page"],"sourcesContent":["<template>\n    <view class=\"container\">\n        <view class=\"title\">测试获取用户信息</view>\n        \n        <button class=\"test-btn\" @click=\"testGetUserProfile\">\n            点击获取用户信息\n        </button>\n        \n        <view class=\"result\" v-if=\"userInfo\">\n            <text class=\"label\">昵称：{{ userInfo.nickName }}</text>\n            <text class=\"label\">头像：</text>\n            <image class=\"avatar\" :src=\"userInfo.avatarUrl\" mode=\"aspectFill\"></image>\n        </view>\n        \n        <view class=\"log\">\n            <text class=\"log-title\">日志：</text>\n            <text class=\"log-item\" v-for=\"(log, index) in logs\" :key=\"index\">{{ log }}</text>\n        </view>\n    </view>\n</template>\n\n<script>\nimport { updateUserInfo } from '@/api/auth';\n\nexport default {\n    data() {\n        return {\n            userInfo: null,\n            logs: []\n        };\n    },\n    methods: {\n        addLog(msg) {\n            this.logs.push(`[${new Date().toLocaleTimeString()}] ${msg}`);\n        },\n        \n        testGetUserProfile() {\n            this.addLog('开始调用 getUserProfile...');\n            \n            uni.getUserProfile({\n                desc: '用于测试获取用户信息',\n                success: async (res) => {\n                    this.addLog('✅ getUserProfile 成功');\n                    this.addLog(`昵称: ${res.userInfo.nickName}`);\n                    this.addLog(`头像: ${res.userInfo.avatarUrl.substring(0, 50)}...`);\n                    \n                    this.userInfo = res.userInfo;\n                    \n                    // 更新到服务器\n                    try {\n                        this.addLog('开始更新到服务器...');\n                        const updateRes = await updateUserInfo({\n                            nickname: res.userInfo.nickName,\n                            avatarUrl: res.userInfo.avatarUrl\n                        });\n                        \n                        if (updateRes.code === 200) {\n                            this.addLog('✅ 服务器更新成功');\n                            uni.showToast({\n                                title: '更新成功',\n                                icon: 'success'\n                            });\n                        } else {\n                            this.addLog(`❌ 服务器更新失败: ${updateRes.message}`);\n                        }\n                    } catch (error) {\n                        this.addLog(`❌ 更新失败: ${error.message}`);\n                    }\n                },\n                fail: (error) => {\n                    this.addLog(`❌ getUserProfile 失败: ${JSON.stringify(error)}`);\n                    uni.showToast({\n                        title: '获取失败或用户拒绝',\n                        icon: 'none'\n                    });\n                }\n            });\n        }\n    }\n};\n</script>\n\n<style scoped>\n.container {\n    padding: 40rpx;\n}\n\n.title {\n    font-size: 36rpx;\n    font-weight: bold;\n    margin-bottom: 40rpx;\n    text-align: center;\n}\n\n.test-btn {\n    width: 100%;\n    height: 88rpx;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: #FFFFFF;\n    border-radius: 44rpx;\n    font-size: 32rpx;\n    border: none;\n    margin-bottom: 40rpx;\n}\n\n.result {\n    background: #F5F5F5;\n    padding: 30rpx;\n    border-radius: 16rpx;\n    margin-bottom: 40rpx;\n}\n\n.label {\n    display: block;\n    font-size: 28rpx;\n    margin-bottom: 20rpx;\n}\n\n.avatar {\n    width: 120rpx;\n    height: 120rpx;\n    border-radius: 60rpx;\n}\n\n.log {\n    background: #000000;\n    padding: 20rpx;\n    border-radius: 8rpx;\n    max-height: 600rpx;\n    overflow-y: scroll;\n}\n\n.log-title {\n    display: block;\n    color: #00FF00;\n    font-size: 24rpx;\n    margin-bottom: 10rpx;\n}\n\n.log-item {\n    display: block;\n    color: #FFFFFF;\n    font-size: 22rpx;\n    line-height: 1.6;\n    margin-bottom: 5rpx;\n    font-family: monospace;\n}\n</style>\n","import MiniProgramPage from '/Users/sunyizhong/uni-app/HBuilderProjects/taskuniapp/pages/test-userinfo.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","updateUserInfo"],"mappings":";;;AAwBA,MAAK,YAAU;AAAA,EACX,OAAO;AACH,WAAO;AAAA,MACH,UAAU;AAAA,MACV,MAAM,CAAC;AAAA;EAEd;AAAA,EACD,SAAS;AAAA,IACL,OAAO,KAAK;AACR,WAAK,KAAK,KAAK,KAAI,oBAAI,QAAO,oBAAoB,KAAK,GAAG,EAAE;AAAA,IAC/D;AAAA,IAED,qBAAqB;AACjB,WAAK,OAAO,wBAAwB;AAEpCA,oBAAAA,MAAI,eAAe;AAAA,QACf,MAAM;AAAA,QACN,SAAS,OAAO,QAAQ;AACpB,eAAK,OAAO,qBAAqB;AACjC,eAAK,OAAO,OAAO,IAAI,SAAS,QAAQ,EAAE;AAC1C,eAAK,OAAO,OAAO,IAAI,SAAS,UAAU,UAAU,GAAG,EAAE,CAAC,KAAK;AAE/D,eAAK,WAAW,IAAI;AAGpB,cAAI;AACA,iBAAK,OAAO,aAAa;AACzB,kBAAM,YAAY,MAAMC,wBAAe;AAAA,cACnC,UAAU,IAAI,SAAS;AAAA,cACvB,WAAW,IAAI,SAAS;AAAA,YAC5B,CAAC;AAED,gBAAI,UAAU,SAAS,KAAK;AACxB,mBAAK,OAAO,WAAW;AACvBD,4BAAAA,MAAI,UAAU;AAAA,gBACV,OAAO;AAAA,gBACP,MAAM;AAAA,cACV,CAAC;AAAA,mBACE;AACH,mBAAK,OAAO,cAAc,UAAU,OAAO,EAAE;AAAA,YACjD;AAAA,UACF,SAAO,OAAO;AACZ,iBAAK,OAAO,WAAW,MAAM,OAAO,EAAE;AAAA,UAC1C;AAAA,QACH;AAAA,QACD,MAAM,CAAC,UAAU;AACb,eAAK,OAAO,wBAAwB,KAAK,UAAU,KAAK,CAAC,EAAE;AAC3DA,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO;AAAA,YACP,MAAM;AAAA,UACV,CAAC;AAAA,QACL;AAAA,MACJ,CAAC;AAAA,IACL;AAAA,EACJ;AACJ;;;;;;;;;;;;;;;;;;AC9EA,GAAG,WAAW,eAAe;"}