{"version":3,"file":"achievement.js","sources":["pages/achievement/achievement.vue","pages/achievement/achievement.vue?type=page"],"sourcesContent":["<template>\n    <view class=\"container\">\n        <!-- 头部统计 -->\n        <view class=\"header-card\">\n            <view class=\"achievement-count\">\n                <text class=\"count-num\">{{ unlockedCount }}</text>\n                <text class=\"count-total\">/{{ totalCount }}</text>\n            </view>\n            <text class=\"header-title\">已解锁成就</text>\n            <view class=\"progress-ring\">\n                <view class=\"progress-text\">{{ completionRate }}%</view>\n            </view>\n        </view>\n\n        <!-- 成就列表 -->\n        <view class=\"achievement-list\">\n            <view v-for=\"(item, index) in achievements\" :key=\"index\" class=\"achievement-item\"\n                :class=\"{ unlocked: item.unlocked }\">\n                <view class=\"achievement-icon\">\n                    <text class=\"icon-emoji\">{{ item.icon }}</text>\n                    <view v-if=\"item.unlocked\" class=\"unlock-badge\">\n                        <text class=\"badge-text\">✓</text>\n                    </view>\n                </view>\n\n                <view class=\"achievement-content\">\n                    <view class=\"achievement-header\">\n                        <text class=\"achievement-name\">{{ item.name }}</text>\n                        <text v-if=\"item.unlocked\" class=\"unlock-time\">\n                            {{ formatDate(item.unlockedAt) }}\n                        </text>\n                    </view>\n\n                    <text class=\"achievement-desc\">{{ item.desc }}</text>\n\n                    <!-- 进度条 -->\n                    <view v-if=\"!item.unlocked\" class=\"progress-bar\">\n                        <view class=\"progress-fill\" :style=\"{ width: item.progress.percentage + '%' }\"></view>\n                    </view>\n                    <text v-if=\"!item.unlocked\" class=\"progress-text\">\n                        {{ item.progress.current }}/{{ item.progress.target }}\n                    </text>\n                </view>\n            </view>\n        </view>\n    </view>\n</template>\n\n<script>\nimport { getAchievements } from '@/api/achievement';\n\nexport default {\n    data() {\n        return {\n            achievements: [],\n            unlockedCount: 0,\n            totalCount: 0,\n            completionRate: 0\n        };\n    },\n    onLoad() {\n        this.loadAchievements();\n    },\n    onShow() {\n        // 从其他页面返回时刷新\n        this.loadAchievements();\n    },\n    methods: {\n        async loadAchievements() {\n            try {\n                uni.showLoading({ title: '加载中...' });\n\n                const res = await getAchievements();\n\n                if (res.code === 200) {\n                    // 按解锁状态排序：已解锁的在前\n                    this.achievements = res.data.achievements.sort((a, b) => {\n                        if (a.unlocked && !b.unlocked) return -1;\n                        if (!a.unlocked && b.unlocked) return 1;\n                        return 0;\n                    });\n\n                    this.unlockedCount = res.data.unlockedCount;\n                    this.totalCount = res.data.totalCount;\n                    this.completionRate = Math.round((this.unlockedCount / this.totalCount) * 100);\n                }\n\n                uni.hideLoading();\n            } catch (error) {\n                uni.hideLoading();\n                console.error('加载成就失败:', error);\n                uni.showToast({\n                    title: '加载失败',\n                    icon: 'none'\n                });\n            }\n        },\n\n        formatDate(dateStr) {\n            if (!dateStr) return '';\n            const date = new Date(dateStr);\n            const month = date.getMonth() + 1;\n            const day = date.getDate();\n            return `${month}月${day}日解锁`;\n        }\n    }\n};\n</script>\n\n<style scoped>\n.container {\n    min-height: 100vh;\n    background: #F5F5F5;\n    padding: 20rpx;\n    padding-bottom: 100rpx;\n}\n\n.header-card {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    border-radius: 16rpx;\n    padding: 50rpx 40rpx;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    margin-bottom: 20rpx;\n    position: relative;\n}\n\n.achievement-count {\n    display: flex;\n    align-items: baseline;\n    margin-bottom: 10rpx;\n}\n\n.count-num {\n    font-size: 80rpx;\n    font-weight: bold;\n    color: #FFFFFF;\n}\n\n.count-total {\n    font-size: 40rpx;\n    color: rgba(255, 255, 255, 0.8);\n    margin-left: 10rpx;\n}\n\n.header-title {\n    font-size: 28rpx;\n    color: rgba(255, 255, 255, 0.9);\n    margin-bottom: 20rpx;\n}\n\n.progress-ring {\n    width: 100rpx;\n    height: 100rpx;\n    border-radius: 50%;\n    background: rgba(255, 255, 255, 0.2);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    position: absolute;\n    right: 40rpx;\n    top: 50%;\n    transform: translateY(-50%);\n}\n\n.progress-text {\n    font-size: 24rpx;\n    font-weight: bold;\n    color: #FFFFFF;\n}\n\n.achievement-list {\n    display: flex;\n    flex-direction: column;\n    gap: 15rpx;\n}\n\n.achievement-item {\n    background: #FFFFFF;\n    border-radius: 16rpx;\n    padding: 30rpx;\n    display: flex;\n    align-items: flex-start;\n    opacity: 0.6;\n    transition: all 0.3s;\n}\n\n.achievement-item.unlocked {\n    opacity: 1;\n    box-shadow: 0 4rpx 20rpx rgba(102, 126, 234, 0.15);\n}\n\n.achievement-icon {\n    width: 100rpx;\n    height: 100rpx;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    margin-right: 20rpx;\n    position: relative;\n    flex-shrink: 0;\n}\n\n.achievement-item:not(.unlocked) .achievement-icon {\n    background: #E0E0E0;\n}\n\n.icon-emoji {\n    font-size: 50rpx;\n}\n\n.achievement-item:not(.unlocked) .icon-emoji {\n    filter: grayscale(100%);\n    opacity: 0.5;\n}\n\n.unlock-badge {\n    position: absolute;\n    right: -5rpx;\n    top: -5rpx;\n    width: 35rpx;\n    height: 35rpx;\n    background: #4CAF50;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border: 3rpx solid #FFFFFF;\n}\n\n.badge-text {\n    font-size: 20rpx;\n    color: #FFFFFF;\n    font-weight: bold;\n}\n\n.achievement-content {\n    flex: 1;\n}\n\n.achievement-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 10rpx;\n}\n\n.achievement-name {\n    font-size: 30rpx;\n    font-weight: bold;\n    color: #333333;\n}\n\n.unlock-time {\n    font-size: 22rpx;\n    color: #999999;\n}\n\n.achievement-desc {\n    font-size: 26rpx;\n    color: #666666;\n    display: block;\n    margin-bottom: 15rpx;\n}\n\n.progress-bar {\n    height: 8rpx;\n    background: #E0E0E0;\n    border-radius: 4rpx;\n    overflow: hidden;\n    margin-bottom: 8rpx;\n}\n\n.progress-fill {\n    height: 100%;\n    background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);\n    transition: width 0.3s;\n}\n\n.achievement-content .progress-text {\n    font-size: 22rpx;\n    color: #999999;\n}\n</style>\n","import MiniProgramPage from '/Users/sunyizhong/uni-app/HBuilderProjects/taskuniapp/pages/achievement/achievement.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","getAchievements"],"mappings":";;;AAmDA,MAAK,YAAU;AAAA,EACX,OAAO;AACH,WAAO;AAAA,MACH,cAAc,CAAE;AAAA,MAChB,eAAe;AAAA,MACf,YAAY;AAAA,MACZ,gBAAgB;AAAA;EAEvB;AAAA,EACD,SAAS;AACL,SAAK,iBAAgB;AAAA,EACxB;AAAA,EACD,SAAS;AAEL,SAAK,iBAAgB;AAAA,EACxB;AAAA,EACD,SAAS;AAAA,IACL,MAAM,mBAAmB;AACrB,UAAI;AACAA,sBAAAA,MAAI,YAAY,EAAE,OAAO,SAAU,CAAA;AAEnC,cAAM,MAAM,MAAMC,gBAAAA;AAElB,YAAI,IAAI,SAAS,KAAK;AAElB,eAAK,eAAe,IAAI,KAAK,aAAa,KAAK,CAAC,GAAG,MAAM;AACrD,gBAAI,EAAE,YAAY,CAAC,EAAE;AAAU,qBAAO;AACtC,gBAAI,CAAC,EAAE,YAAY,EAAE;AAAU,qBAAO;AACtC,mBAAO;AAAA,UACX,CAAC;AAED,eAAK,gBAAgB,IAAI,KAAK;AAC9B,eAAK,aAAa,IAAI,KAAK;AAC3B,eAAK,iBAAiB,KAAK,MAAO,KAAK,gBAAgB,KAAK,aAAc,GAAG;AAAA,QACjF;AAEAD,sBAAG,MAAC,YAAW;AAAA,MACjB,SAAO,OAAO;AACZA,sBAAG,MAAC,YAAW;AACfA,sBAAA,MAAA,MAAA,SAAA,2CAAc,WAAW,KAAK;AAC9BA,sBAAAA,MAAI,UAAU;AAAA,UACV,OAAO;AAAA,UACP,MAAM;AAAA,QACV,CAAC;AAAA,MACL;AAAA,IACH;AAAA,IAED,WAAW,SAAS;AAChB,UAAI,CAAC;AAAS,eAAO;AACrB,YAAM,OAAO,IAAI,KAAK,OAAO;AAC7B,YAAM,QAAQ,KAAK,SAAQ,IAAK;AAChC,YAAM,MAAM,KAAK;AACjB,aAAO,GAAG,KAAK,IAAI,GAAG;AAAA,IAC1B;AAAA,EACJ;AACJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzGA,GAAG,WAAW,eAAe;"}