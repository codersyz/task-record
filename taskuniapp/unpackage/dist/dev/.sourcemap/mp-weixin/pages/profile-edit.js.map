{"version":3,"file":"profile-edit.js","sources":["pages/profile-edit.vue","pages/profile-edit.vue?type=page"],"sourcesContent":["<template>\n    <view class=\"container\">\n        <view class=\"title\">ÂÆåÂñÑ‰∏™‰∫∫‰ø°ÊÅØ</view>\n        <view class=\"subtitle\">ËØ∑Â°´ÂÜô‰Ω†ÁöÑÊòµÁß∞ÂíåÂ§¥ÂÉè</view>\n\n        <view class=\"form\">\n            <!-- Â§¥ÂÉèÈÄâÊã© -->\n            <view class=\"form-item\">\n                <text class=\"label\">Â§¥ÂÉè</text>\n                <button class=\"avatar-wrapper\" open-type=\"chooseAvatar\" @chooseavatar=\"onChooseAvatar\">\n                    <image class=\"avatar\" :src=\"avatarUrl || '/static/logo.webp'\" mode=\"aspectFill\"></image>\n                    <text class=\"avatar-tip\">ÁÇπÂáªÊõ¥Êç¢Â§¥ÂÉè</text>\n                </button>\n            </view>\n\n            <!-- ÊòµÁß∞ËæìÂÖ• -->\n            <view class=\"form-item\">\n                <text class=\"label\">ÊòµÁß∞</text>\n                <input class=\"input\" type=\"nickname\" v-model=\"nickname\" placeholder=\"ËØ∑ËæìÂÖ•ÊòµÁß∞\" @blur=\"onNicknameBlur\" />\n            </view>\n        </view>\n\n        <view class=\"btn-group\">\n            <button class=\"submit-btn\" @click=\"handleSubmit\" :disabled=\"!canSubmit\">\n                ‰øùÂ≠ò\n            </button>\n            <button class=\"skip-btn\" @click=\"handleSkip\">\n                Ë∑≥Ëøá\n            </button>\n        </view>\n\n        <view class=\"tips\">\n            <text class=\"tip-text\">üí° ÊèêÁ§∫ÔºöÂ§¥ÂÉèÂíåÊòµÁß∞Áî®‰∫éÂú®Â∞èÁ®ãÂ∫è‰∏≠Â±ïÁ§∫‰Ω†ÁöÑ‰∏™‰∫∫‰ø°ÊÅØ</text>\n        </view>\n    </view>\n</template>\n\n<script>\nimport { updateUserInfo } from '@/api/auth';\n\nexport default {\n    data() {\n        return {\n            avatarUrl: '',\n            nickname: '',\n            fromLogin: false\n        };\n    },\n    computed: {\n        canSubmit() {\n            return this.nickname.trim().length > 0;\n        }\n    },\n    onLoad(options) {\n        this.fromLogin = options.fromLogin === 'true';\n    },\n    methods: {\n        // ÈÄâÊã©Â§¥ÂÉè\n        onChooseAvatar(e) {\n            console.log('ÈÄâÊã©Â§¥ÂÉè:', e);\n            const { avatarUrl } = e.detail;\n            this.avatarUrl = avatarUrl;\n            console.log('Â§¥ÂÉèURL:', avatarUrl);\n        },\n\n        // ÊòµÁß∞ËæìÂÖ•ÂÆåÊàê\n        onNicknameBlur(e) {\n            console.log('ÊòµÁß∞ËæìÂÖ•:', e.detail.value);\n            this.nickname = e.detail.value;\n        },\n\n        // Êèê‰∫§\n        async handleSubmit() {\n            if (!this.canSubmit) {\n                uni.showToast({\n                    title: 'ËØ∑ËæìÂÖ•ÊòµÁß∞',\n                    icon: 'none'\n                });\n                return;\n            }\n\n            try {\n                uni.showLoading({\n                    title: '‰øùÂ≠ò‰∏≠...'\n                });\n\n                console.log('ÂáÜÂ§á‰∏ä‰º†:', {\n                    nickname: this.nickname,\n                    avatarUrl: this.avatarUrl\n                });\n\n                // Â¶ÇÊûúÊúâÂ§¥ÂÉèÔºåÂÖà‰∏ä‰º†\n                let finalAvatarUrl = this.avatarUrl;\n                if (this.avatarUrl && this.avatarUrl.startsWith('http://tmp/')) {\n                    // ‰∏¥Êó∂Êñá‰ª∂ÔºåÈúÄË¶Å‰∏ä‰º†Âà∞ÊúçÂä°Âô®\n                    // ËøôÈáåÁÆÄÂåñÂ§ÑÁêÜÔºåÁõ¥Êé•‰ΩøÁî®‰∏¥Êó∂URL\n                    // Áîü‰∫ßÁéØÂ¢ÉÂ∫îËØ•‰∏ä‰º†Âà∞Ëá™Â∑±ÁöÑÊúçÂä°Âô®Êàñ‰∫ëÂ≠òÂÇ®\n                    console.log('‰ΩøÁî®‰∏¥Êó∂Â§¥ÂÉèURL');\n                }\n\n                // Êõ¥Êñ∞Áî®Êà∑‰ø°ÊÅØ\n                const res = await updateUserInfo({\n                    nickname: this.nickname,\n                    avatarUrl: finalAvatarUrl || '/static/logo.webp'\n                });\n\n                uni.hideLoading();\n\n                if (res.code === 200) {\n                    uni.showToast({\n                        title: '‰øùÂ≠òÊàêÂäü',\n                        icon: 'success'\n                    });\n\n                    setTimeout(() => {\n                        if (this.fromLogin) {\n                            // ‰ªéÁôªÂΩïÈ°µÊù•ÁöÑÔºåË∑≥ËΩ¨Âà∞È¶ñÈ°µ\n                            uni.switchTab({\n                                url: '/pages/index/index'\n                            });\n                        } else {\n                            // ‰ªé‰∏™‰∫∫‰∏≠ÂøÉÊù•ÁöÑÔºåËøîÂõû\n                            uni.navigateBack();\n                        }\n                    }, 1000);\n                } else {\n                    uni.showToast({\n                        title: res.message || '‰øùÂ≠òÂ§±Ë¥•',\n                        icon: 'none'\n                    });\n                }\n            } catch (error) {\n                uni.hideLoading();\n                console.error('‰øùÂ≠òÂ§±Ë¥•:', error);\n                uni.showToast({\n                    title: '‰øùÂ≠òÂ§±Ë¥•',\n                    icon: 'none'\n                });\n            }\n        },\n\n        // Ë∑≥Ëøá\n        handleSkip() {\n            if (this.fromLogin) {\n                uni.switchTab({\n                    url: '/pages/index/index'\n                });\n            } else {\n                uni.navigateBack();\n            }\n        }\n    }\n};\n</script>\n\n<style scoped>\n.container {\n    min-height: 100vh;\n    background: #F5F5F5;\n    padding: 40rpx;\n}\n\n.title {\n    font-size: 40rpx;\n    font-weight: bold;\n    color: #333333;\n    text-align: center;\n    margin-bottom: 20rpx;\n}\n\n.subtitle {\n    font-size: 28rpx;\n    color: #999999;\n    text-align: center;\n    margin-bottom: 60rpx;\n}\n\n.form {\n    background: #FFFFFF;\n    border-radius: 16rpx;\n    padding: 40rpx;\n    margin-bottom: 40rpx;\n}\n\n.form-item {\n    margin-bottom: 40rpx;\n}\n\n.form-item:last-child {\n    margin-bottom: 0;\n}\n\n.label {\n    display: block;\n    font-size: 28rpx;\n    color: #333333;\n    margin-bottom: 20rpx;\n    font-weight: bold;\n}\n\n.avatar-wrapper {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: 40rpx;\n    background: #F5F5F5;\n    border-radius: 16rpx;\n    border: none;\n}\n\n.avatar {\n    width: 160rpx;\n    height: 160rpx;\n    border-radius: 80rpx;\n    margin-bottom: 20rpx;\n}\n\n.avatar-tip {\n    font-size: 24rpx;\n    color: #999999;\n}\n\n.input {\n    width: 100%;\n    height: 80rpx;\n    background: #F5F5F5;\n    border-radius: 8rpx;\n    padding: 0 20rpx;\n    font-size: 28rpx;\n}\n\n.btn-group {\n    margin-bottom: 40rpx;\n}\n\n.submit-btn {\n    width: 100%;\n    height: 88rpx;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: #FFFFFF;\n    border-radius: 44rpx;\n    font-size: 32rpx;\n    border: none;\n    margin-bottom: 20rpx;\n}\n\n.submit-btn[disabled] {\n    background: #CCCCCC;\n}\n\n.skip-btn {\n    width: 100%;\n    height: 88rpx;\n    background: #FFFFFF;\n    color: #666666;\n    border-radius: 44rpx;\n    font-size: 28rpx;\n    border: 1rpx solid #E0E0E0;\n}\n\n.tips {\n    padding: 20rpx;\n}\n\n.tip-text {\n    font-size: 24rpx;\n    color: #999999;\n    line-height: 1.6;\n}\n</style>\n","import MiniProgramPage from '/Users/sunyizhong/uni-app/HBuilderProjects/taskuniapp/pages/profile-edit.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","updateUserInfo"],"mappings":";;;AAwCA,MAAK,YAAU;AAAA,EACX,OAAO;AACH,WAAO;AAAA,MACH,WAAW;AAAA,MACX,UAAU;AAAA,MACV,WAAW;AAAA;EAElB;AAAA,EACD,UAAU;AAAA,IACN,YAAY;AACR,aAAO,KAAK,SAAS,KAAI,EAAG,SAAS;AAAA,IACzC;AAAA,EACH;AAAA,EACD,OAAO,SAAS;AACZ,SAAK,YAAY,QAAQ,cAAc;AAAA,EAC1C;AAAA,EACD,SAAS;AAAA;AAAA,IAEL,eAAe,GAAG;AACdA,uEAAY,SAAS,CAAC;AACtB,YAAM,EAAE,UAAQ,IAAM,EAAE;AACxB,WAAK,YAAY;AACjBA,oBAAY,MAAA,MAAA,OAAA,gCAAA,UAAU,SAAS;AAAA,IAClC;AAAA;AAAA,IAGD,eAAe,GAAG;AACdA,0BAAY,MAAA,OAAA,gCAAA,SAAS,EAAE,OAAO,KAAK;AACnC,WAAK,WAAW,EAAE,OAAO;AAAA,IAC5B;AAAA;AAAA,IAGD,MAAM,eAAe;AACjB,UAAI,CAAC,KAAK,WAAW;AACjBA,sBAAAA,MAAI,UAAU;AAAA,UACV,OAAO;AAAA,UACP,MAAM;AAAA,QACV,CAAC;AACD;AAAA,MACJ;AAEA,UAAI;AACAA,sBAAAA,MAAI,YAAY;AAAA,UACZ,OAAO;AAAA,QACX,CAAC;AAEDA,sBAAAA,MAAY,MAAA,OAAA,gCAAA,SAAS;AAAA,UACjB,UAAU,KAAK;AAAA,UACf,WAAW,KAAK;AAAA,QACpB,CAAC;AAGD,YAAI,iBAAiB,KAAK;AAC1B,YAAI,KAAK,aAAa,KAAK,UAAU,WAAW,aAAa,GAAG;AAI5DA,wBAAAA,MAAA,MAAA,OAAA,gCAAY,WAAW;AAAA,QAC3B;AAGA,cAAM,MAAM,MAAMC,wBAAe;AAAA,UAC7B,UAAU,KAAK;AAAA,UACf,WAAW,kBAAkB;AAAA,QACjC,CAAC;AAEDD,sBAAG,MAAC,YAAW;AAEf,YAAI,IAAI,SAAS,KAAK;AAClBA,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO;AAAA,YACP,MAAM;AAAA,UACV,CAAC;AAED,qBAAW,MAAM;AACb,gBAAI,KAAK,WAAW;AAEhBA,4BAAAA,MAAI,UAAU;AAAA,gBACV,KAAK;AAAA,cACT,CAAC;AAAA,mBACE;AAEHA,4BAAG,MAAC,aAAY;AAAA,YACpB;AAAA,UACH,GAAE,GAAI;AAAA,eACJ;AACHA,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO,IAAI,WAAW;AAAA,YACtB,MAAM;AAAA,UACV,CAAC;AAAA,QACL;AAAA,MACF,SAAO,OAAO;AACZA,sBAAG,MAAC,YAAW;AACfA,sBAAc,MAAA,MAAA,SAAA,iCAAA,SAAS,KAAK;AAC5BA,sBAAAA,MAAI,UAAU;AAAA,UACV,OAAO;AAAA,UACP,MAAM;AAAA,QACV,CAAC;AAAA,MACL;AAAA,IACH;AAAA;AAAA,IAGD,aAAa;AACT,UAAI,KAAK,WAAW;AAChBA,sBAAAA,MAAI,UAAU;AAAA,UACV,KAAK;AAAA,QACT,CAAC;AAAA,aACE;AACHA,sBAAG,MAAC,aAAY;AAAA,MACpB;AAAA,IACJ;AAAA,EACJ;AACJ;;;;;;;;;;;;;;ACvJA,GAAG,WAAW,eAAe;"}