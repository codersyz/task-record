{"version":3,"file":"detail.js","sources":["pages/task/detail.vue","pages/task/detail.vue?type=page"],"sourcesContent":["<template>\n    <view class=\"container\">\n        <!-- ‰ªªÂä°‰ø°ÊÅØ -->\n        <view class=\"task-card\">\n            <view class=\"task-header\">\n                <text class=\"task-title\">{{ task.title }}</text>\n                <view class=\"task-actions\" @click=\"showActionSheet\">\n                    <text class=\"action-icon\">‚ãØ</text>\n                </view>\n            </view>\n            <text v-if=\"task.description\" class=\"task-desc\">{{ task.description }}</text>\n\n            <view class=\"stats\">\n                <view class=\"stat-item\">\n                    <text class=\"stat-num\">{{ task.current_days }}</text>\n                    <text class=\"stat-label\">ËøûÁª≠Â§©Êï∞</text>\n                </view>\n                <view class=\"stat-item\">\n                    <text class=\"stat-num\">{{ task.total_days }}</text>\n                    <text class=\"stat-label\">Á¥ØËÆ°Â§©Êï∞</text>\n                </view>\n                <view class=\"stat-item\" v-if=\"task.target_days > 0\">\n                    <text class=\"stat-num\">{{ task.target_days }}</text>\n                    <text class=\"stat-label\">ÁõÆÊ†áÂ§©Êï∞</text>\n                </view>\n            </view>\n        </view>\n\n        <!-- ÊâìÂç°ÊåâÈíÆ -->\n        <view class=\"checkin-section\">\n            <!-- ‰ªªÂä°Â∑≤ÂÆåÊàê -->\n            <button v-if=\"task.status === 0\" class=\"checkin-btn completed\" disabled>\n                <text>üéâ ‰ªªÂä°Â∑≤ÂÆåÊàê</text>\n            </button>\n            <!-- ‰ªäÊó•Â∑≤ÊâìÂç° -->\n            <button v-else-if=\"hasCheckedToday\" class=\"checkin-btn checked\" disabled>\n                <text>‚úì Â∑≤ÊâìÂç°</text>\n            </button>\n            <!-- ÂèØ‰ª•ÊâìÂç° -->\n            <button v-else class=\"checkin-btn\" @click=\"goToCheckin\">\n                <text>Á´ãÂç≥ÊâìÂç°</text>\n            </button>\n\n            <text v-if=\"task.status === 0\" class=\"checkin-tip\">\n                Â∑≤ÂÆåÊàêÁõÆÊ†á {{ task.target_days }} Â§©ÊâìÂç°\n            </text>\n            <text v-else-if=\"hasCheckedToday\" class=\"checkin-tip\">\n                ÊòéÂ§©ÂÜçÊù•ÊâìÂç°Âêß~\n            </text>\n        </view>\n\n        <!-- ÊâìÂç°ËÆ∞ÂΩï -->\n        <view class=\"records\">\n            <text class=\"section-title\">ÊâìÂç°ËÆ∞ÂΩï</text>\n\n            <view v-if=\"checkinList.length === 0\" class=\"empty\">\n                <text class=\"empty-text\">ÊöÇÊó†ÊâìÂç°ËÆ∞ÂΩï</text>\n            </view>\n\n            <view v-for=\"item in checkinList\" :key=\"item.id\" class=\"record-item\">\n                <view class=\"record-date\">{{ formatDate(item.checkin_date) }}</view>\n                <view v-if=\"item.note\" class=\"record-note\">{{ item.note }}</view>\n            </view>\n        </view>\n    </view>\n</template>\n\n<script>\nimport { getTaskDetail, checkTodayCheckin, getCheckinList, deleteTask } from '@/api/task';\n\nexport default {\n    data() {\n        return {\n            taskId: 0,\n            task: {},\n            checkinList: [],\n            hasCheckedToday: false\n        };\n    },\n    onLoad(options) {\n        this.taskId = options.id;\n        this.loadData();\n    },\n    onShow() {\n        // ‰ªéÊâìÂç°È°µËøîÂõûÊó∂ÔºåÈáçÊñ∞Âä†ËΩΩÊâÄÊúâÊï∞ÊçÆ\n        if (this.taskId) {\n            this.loadData();\n        }\n    },\n    methods: {\n        async loadData() {\n            await this.loadTaskDetail();\n            await this.checkTodayStatus();\n            await this.loadCheckinList();\n        },\n\n        async loadTaskDetail() {\n            try {\n                const res = await getTaskDetail(this.taskId);\n                if (res.code === 200) {\n                    this.task = res.data;\n                }\n            } catch (error) {\n                console.error('Âä†ËΩΩ‰ªªÂä°ËØ¶ÊÉÖÂ§±Ë¥•:', error);\n            }\n        },\n\n        // Ë∞ÉÁî®Êé•Âè£Ê£ÄÊü•‰ªäÂ§©ÊòØÂê¶Â∑≤ÊâìÂç°\n        async checkTodayStatus() {\n            try {\n                console.log('Ê£ÄÊü•‰ªäÊó•ÊâìÂç°Áä∂ÊÄÅ - taskId:', this.taskId);\n\n                const res = await checkTodayCheckin(this.taskId);\n                console.log('ÊâìÂç°Áä∂ÊÄÅÂìçÂ∫î:', res);\n\n                if (res.code === 200) {\n                    this.hasCheckedToday = res.data.hasChecked;\n                    console.log('‰ªäÊó•ÊòØÂê¶Â∑≤ÊâìÂç°:', this.hasCheckedToday);\n                }\n            } catch (error) {\n                console.error('Ê£ÄÊü•ÊâìÂç°Áä∂ÊÄÅÂ§±Ë¥•:', error);\n            }\n        },\n\n        async loadCheckinList() {\n            try {\n                const res = await getCheckinList(this.taskId, 1, 20);\n                if (res.code === 200) {\n                    this.checkinList = res.data;\n                }\n            } catch (error) {\n                console.error('Âä†ËΩΩÊâìÂç°ËÆ∞ÂΩïÈîôËØØ:', error);\n            }\n        },\n\n        goToCheckin() {\n            if (this.hasCheckedToday) {\n                uni.showToast({\n                    title: '‰ªäÂ§©Â∑≤ÁªèÊâìÂç°Ëøá‰∫Ü',\n                    icon: 'none'\n                });\n                return;\n            }\n\n            uni.navigateTo({\n                url: `/pages/checkin/checkin?taskId=${this.taskId}`\n            });\n        },\n\n        // ÊòæÁ§∫Êìç‰ΩúËèúÂçï\n        showActionSheet() {\n            uni.showActionSheet({\n                itemList: ['ÁºñËæë‰ªªÂä°', 'Âà†Èô§‰ªªÂä°'],\n                success: (res) => {\n                    if (res.tapIndex === 0) {\n                        // ÁºñËæë‰ªªÂä°\n                        this.editTask();\n                    } else if (res.tapIndex === 1) {\n                        // Âà†Èô§‰ªªÂä°\n                        this.confirmDelete();\n                    }\n                }\n            });\n        },\n\n        // ÁºñËæë‰ªªÂä°ÔºàÊöÇÊú™ÂÆûÁé∞Ôºâ\n        editTask() {\n            uni.showToast({\n                title: 'ÁºñËæëÂäüËÉΩÂºÄÂèë‰∏≠',\n                icon: 'none'\n            });\n        },\n\n        // Á°ÆËÆ§Âà†Èô§\n        confirmDelete() {\n            uni.showModal({\n                title: 'Á°ÆËÆ§Âà†Èô§',\n                content: 'Âà†Èô§ÂêéÂ∞ÜÊó†Ê≥ïÊÅ¢Â§çÔºåÁ°ÆÂÆöË¶ÅÂà†Èô§Ëøô‰∏™‰ªªÂä°ÂêóÔºü',\n                confirmText: 'Âà†Èô§',\n                confirmColor: '#FF3B30',\n                success: async (res) => {\n                    if (res.confirm) {\n                        await this.handleDelete();\n                    }\n                }\n            });\n        },\n\n        // ÊâßË°åÂà†Èô§\n        async handleDelete() {\n            try {\n                uni.showLoading({\n                    title: 'Âà†Èô§‰∏≠...'\n                });\n\n                const res = await deleteTask(this.taskId);\n\n                uni.hideLoading();\n\n                if (res.code === 200) {\n                    uni.showToast({\n                        title: 'Âà†Èô§ÊàêÂäü',\n                        icon: 'success'\n                    });\n\n                    setTimeout(() => {\n                        uni.navigateBack();\n                    }, 1000);\n                } else {\n                    uni.showToast({\n                        title: res.message || 'Âà†Èô§Â§±Ë¥•',\n                        icon: 'none'\n                    });\n                }\n            } catch (error) {\n                uni.hideLoading();\n                console.error('Âà†Èô§‰ªªÂä°Â§±Ë¥•:', error);\n                uni.showToast({\n                    title: 'Âà†Èô§Â§±Ë¥•ÔºåËØ∑ÈáçËØï',\n                    icon: 'none'\n                });\n            }\n        },\n\n        formatDate(dateStr) {\n            const date = new Date(dateStr);\n            const month = date.getMonth() + 1;\n            const day = date.getDate();\n            const weekdays = ['Êó•', '‰∏Ä', '‰∫å', '‰∏â', 'Âõõ', '‰∫î', 'ÂÖ≠'];\n            const weekday = weekdays[date.getDay()];\n            return `${month}Êúà${day}Êó• ÊòüÊúü${weekday}`;\n        }\n    }\n};\n</script>\n\n<style scoped>\n.container {\n    min-height: 100vh;\n    background: #F5F5F5;\n    padding: 20rpx;\n}\n\n.task-card {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    border-radius: 16rpx;\n    padding: 40rpx;\n    margin-bottom: 20rpx;\n}\n\n.task-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-start;\n    margin-bottom: 20rpx;\n}\n\n.task-title {\n    font-size: 36rpx;\n    font-weight: bold;\n    color: #FFFFFF;\n    flex: 1;\n}\n\n.task-actions {\n    padding: 0 10rpx;\n    margin-left: 20rpx;\n}\n\n.action-icon {\n    font-size: 40rpx;\n    color: #FFFFFF;\n    font-weight: bold;\n    line-height: 1;\n}\n\n.task-desc {\n    font-size: 28rpx;\n    color: rgba(255, 255, 255, 0.8);\n    display: block;\n    margin-bottom: 30rpx;\n}\n\n.stats {\n    display: flex;\n    justify-content: space-around;\n    margin-top: 30rpx;\n}\n\n.stat-item {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n}\n\n.stat-num {\n    font-size: 48rpx;\n    font-weight: bold;\n    color: #FFFFFF;\n}\n\n.stat-label {\n    font-size: 24rpx;\n    color: rgba(255, 255, 255, 0.8);\n    margin-top: 10rpx;\n}\n\n.checkin-section {\n    margin-bottom: 20rpx;\n}\n\n.checkin-btn {\n    width: 100%;\n    height: 88rpx;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: #FFFFFF;\n    border-radius: 44rpx;\n    font-size: 32rpx;\n    border: none;\n    transition: all 0.3s;\n}\n\n.checkin-btn.checked {\n    background: #E8F5E9;\n    color: #4CAF50;\n}\n\n.checkin-btn.completed {\n    background: #FFF3E0;\n    color: #FF9800;\n}\n\n.checkin-btn[disabled] {\n    opacity: 1;\n}\n\n.checkin-tip {\n    display: block;\n    text-align: center;\n    font-size: 24rpx;\n    color: #999999;\n    margin-top: 15rpx;\n}\n\n.records {\n    background: #FFFFFF;\n    border-radius: 16rpx;\n    padding: 30rpx;\n}\n\n.section-title {\n    font-size: 32rpx;\n    font-weight: bold;\n    color: #333333;\n    display: block;\n    margin-bottom: 20rpx;\n}\n\n.empty {\n    text-align: center;\n    padding: 60rpx 0;\n}\n\n.empty-text {\n    font-size: 28rpx;\n    color: #999999;\n}\n\n.record-item {\n    padding: 20rpx 0;\n    border-bottom: 1rpx solid #F0F0F0;\n}\n\n.record-item:last-child {\n    border-bottom: none;\n}\n\n.record-date {\n    font-size: 28rpx;\n    color: #333333;\n    margin-bottom: 10rpx;\n}\n\n.record-note {\n    font-size: 26rpx;\n    color: #666666;\n}\n</style>\n","import MiniProgramPage from '/Users/sunyizhong/uni-app/HBuilderProjects/taskuniapp/pages/task/detail.vue'\nwx.createPage(MiniProgramPage)"],"names":["getTaskDetail","uni","checkTodayCheckin","getCheckinList","deleteTask"],"mappings":"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"}