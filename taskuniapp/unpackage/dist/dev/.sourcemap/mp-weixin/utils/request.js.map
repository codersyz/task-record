{"version":3,"file":"request.js","sources":["utils/request.js"],"sourcesContent":["// API请求封装\n// 使用主域名 + 子路径方案\n\n// 开发环境：本地或局域网（开发时使用）\n// const BASE_URL = 'http://192.168.202.53:3003/api'; // 真机调试地址\n// const BASE_URL = 'http://localhost:3003/api'; // 开发者工具地址\n// const BASE_URL = 'http://43.142.65.192:3003/api'; // 服务器IP地址（临时测试）\n\n// 生产环境：HTTPS域名（正式发布使用）\nconst BASE_URL = 'https://syztools.cn/task-api/api'; // 生产服务器地址\n\n// 注意：微信小程序正式发布必须使用HTTPS和已备案的域名\n\n// 请求拦截器\nconst request = (options) => {\n  return new Promise((resolve, reject) => {\n    // 获取token\n    const token = uni.getStorageSync('token');\n    \n    uni.request({\n      url: BASE_URL + options.url,\n      method: options.method || 'GET',\n      data: options.data || {},\n      header: {\n        'Content-Type': 'application/json',\n        'Authorization': token ? `Bearer ${token}` : ''\n      },\n      success: (res) => {\n        if (res.statusCode === 200) {\n          resolve(res.data);\n        } else if (res.statusCode === 401) {\n          // token过期，跳转登录\n          uni.removeStorageSync('token');\n          uni.reLaunch({\n            url: '/pages/login/login'\n          });\n          reject(res.data);\n        } else {\n          uni.showToast({\n            title: res.data.message || '请求失败',\n            icon: 'none'\n          });\n          reject(res.data);\n        }\n      },\n      fail: (err) => {\n        uni.showToast({\n          title: '网络请求失败',\n          icon: 'none'\n        });\n        reject(err);\n      }\n    });\n  });\n};\n\n// 导出请求方法\nexport default {\n  get(url, data) {\n    return request({ url, method: 'GET', data });\n  },\n  post(url, data) {\n    return request({ url, method: 'POST', data });\n  },\n  put(url, data) {\n    return request({ url, method: 'PUT', data });\n  },\n  delete(url, data) {\n    return request({ url, method: 'DELETE', data });\n  }\n};\n"],"names":["uni"],"mappings":";;AASA,MAAM,WAAW;AAKjB,MAAM,UAAU,CAAC,YAAY;AAC3B,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AAEtC,UAAM,QAAQA,cAAAA,MAAI,eAAe,OAAO;AAExCA,kBAAAA,MAAI,QAAQ;AAAA,MACV,KAAK,WAAW,QAAQ;AAAA,MACxB,QAAQ,QAAQ,UAAU;AAAA,MAC1B,MAAM,QAAQ,QAAQ,CAAE;AAAA,MACxB,QAAQ;AAAA,QACN,gBAAgB;AAAA,QAChB,iBAAiB,QAAQ,UAAU,KAAK,KAAK;AAAA,MAC9C;AAAA,MACD,SAAS,CAAC,QAAQ;AAChB,YAAI,IAAI,eAAe,KAAK;AAC1B,kBAAQ,IAAI,IAAI;AAAA,QAC1B,WAAmB,IAAI,eAAe,KAAK;AAEjCA,8BAAI,kBAAkB,OAAO;AAC7BA,wBAAAA,MAAI,SAAS;AAAA,YACX,KAAK;AAAA,UACjB,CAAW;AACD,iBAAO,IAAI,IAAI;AAAA,QACzB,OAAe;AACLA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO,IAAI,KAAK,WAAW;AAAA,YAC3B,MAAM;AAAA,UAClB,CAAW;AACD,iBAAO,IAAI,IAAI;AAAA,QAChB;AAAA,MACF;AAAA,MACD,MAAM,CAAC,QAAQ;AACbA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QAChB,CAAS;AACD,eAAO,GAAG;AAAA,MACX;AAAA,IACP,CAAK;AAAA,EACL,CAAG;AACH;AAGA,MAAe,YAAA;AAAA,EACb,IAAI,KAAK,MAAM;AACb,WAAO,QAAQ,EAAE,KAAK,QAAQ,OAAO,KAAI,CAAE;AAAA,EAC5C;AAAA,EACD,KAAK,KAAK,MAAM;AACd,WAAO,QAAQ,EAAE,KAAK,QAAQ,QAAQ,KAAI,CAAE;AAAA,EAC7C;AAAA,EACD,IAAI,KAAK,MAAM;AACb,WAAO,QAAQ,EAAE,KAAK,QAAQ,OAAO,KAAI,CAAE;AAAA,EAC5C;AAAA,EACD,OAAO,KAAK,MAAM;AAChB,WAAO,QAAQ,EAAE,KAAK,QAAQ,UAAU,KAAI,CAAE;AAAA,EAC/C;AACH;;"}